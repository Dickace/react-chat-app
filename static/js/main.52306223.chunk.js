(this["webpackJsonpreact-chat-app"]=this["webpackJsonpreact-chat-app"]||[]).push([[0],{13:function(e){e.exports=JSON.parse('{"API_URL":"http://109.194.37.212:93","WS_URL":"ws://109.194.37.212:2346"}')},195:function(e,t,a){},200:function(e,t,a){},201:function(e,t,a){},202:function(e,t,a){},203:function(e,t,a){},204:function(e,t,a){},205:function(e,t,a){},206:function(e,t,a){},207:function(e,t,a){},208:function(e,t,a){},209:function(e,t,a){},210:function(e,t,a){},211:function(e,t,a){},212:function(e,t,a){},213:function(e,t,a){},214:function(e,t,a){"use strict";a.r(t);var n,c=a(1),s=a.n(c),r=a(75),i=a.n(r),o=(a(85),a(86),a(87),a(6));!function(e){e.SCREEN_LOGIN="/login",e.SCREEN_REGISTER="/signup",e.SCREEN_CHAT="/chat",e.SCREEN_CONVERSATION="/chat/:username"}(n||(n={}));var l=a(5),u=a.n(l),d=a(7),j=(a(89),a(0)),p=function(e){var t=e.authPage,a=e.authHeader;return Object(j.jsxs)("div",{className:"wellcomeArea",children:[a,t]})},m=(a(91),a(13)),b=["video/mp4","video/ogg","video/webm","audio/mpeg","audio/ogg","image/jpeg","image/gif","image/png","image/svg+xml"];function f(e){return e&&"function"==typeof e}function h(e){var t=e/1024;return t>512?(t/=1024)>512?"".concat((t/=1024).toFixed(2)," GB"):"".concat(t.toFixed(2)," MB"):"".concat(t.toFixed(2)," KB")}var O=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(m.API_URL,"/api/auth"));case 2:if(!(t=e.sent).ok){e.next=9;break}return e.next=6,t.json();case 6:return e.abrupt("return",e.sent);case 9:return e.abrupt("return","Request error: ".concat(t.status));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function g(e){var t=e.split("/");return t[t.length-1].split(".")[0]}var v=a.p+"static/media/beautyBackground.a8851126.svg",x=a.p+"static/media/beautyBackgroundMobile.12d55e91.svg",N=function(){var e=v;return window.matchMedia("(max-width: 768px)").matches&&(e=x),Object(j.jsx)("img",{className:"beautyBackground",src:e,alt:g(e)})},S=(a(92),a(16)),w=a(2),y=(a(93),a.p+"static/media/info.410775e6.svg"),C=function(e){var t=e.placeholder,a=void 0===t?"InputText":t,n=e.label,s=void 0===n?"Input field":n,r=e.type,i=void 0===r?"text":r,o=e.msg,l=void 0===o?"":o,u=e.readonly,d=void 0!==u&&u,p=e.children,m=e.registerInput,b=Object(c.useState)("regular"),f=Object(w.a)(b,2),h=f[0],O=f[1];return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("label",{className:"inputField",children:[Object(j.jsx)("span",{className:"inputField-label",children:s}),Object(j.jsx)("input",Object(S.a)(Object(S.a)({},m),{},{className:"inputField-input inputField-input__".concat(h),type:i,onFocus:function(){O("typing")},onBlur:function(){O("regular")},placeholder:a,readOnly:d})),l?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("img",{className:"inputField-msgIcon",src:y,alt:g(y)}),Object(j.jsx)("p",{className:"inputField-msg inputField-msg__error",children:l})]}):null]}),p]})},k=(a(94),function(e){var t=e.text,a=e.style,n=void 0===a?"regular":a,c=e.onClick,s=e.isLink,r=void 0!==s&&s,i=e.type,o=void 0===i?"button":i,l=e.children;return Object(j.jsxs)("button",{type:o,className:"button ".concat(r?"button-link":""," ").concat(r?"button-link":"button","__").concat(n),onClick:c,children:[t,l]})}),E=(a(95),a(96),a.p+"static/media/refresh.2a155de8.svg"),I=function(e){var t=e.registerInput,a=e.msg,n=Object(c.useState)(""),s=Object(w.a)(n,2),r=s[0],i=s[1],o=function(){var e=Object(d.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(m.API_URL,"/api/auth/captcha"),{method:"GET",credentials:"include"});case 2:if(!(t=e.sent).ok){e.next=10;break}return e.next=6,t.blob();case 6:a=e.sent,i(URL.createObjectURL(a)),e.next=11;break;case 10:return e.abrupt("return","Error: ".concat(t.status));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){o().catch((function(e){console.log(e)}))}),[]),Object(j.jsxs)("div",{className:"captcha",children:[Object(j.jsxs)("label",{className:"captcha-input",children:[Object(j.jsx)("span",{className:"captcha-label",children:"Security code"}),Object(j.jsx)("input",Object(S.a)(Object(S.a)({className:"captcha-inputField"},t),{},{type:"text",placeholder:"Security code"})),a?Object(j.jsx)("p",{className:"captcha-msg captcha-msg__error",children:a}):null]}),Object(j.jsxs)("div",{className:"captcha-refresh",children:[Object(j.jsx)("img",{className:"captcha-image",src:r,alt:g(r)}),Object(j.jsx)("img",{className:"captcha-refreshIcon",onClick:function(){o().catch((function(e){console.log(e)}))},src:E,alt:g(E)})]})]})},_=a(11),F=a(18),R=a(39),T=(a(195),function(e){var t=e.isHeader,a=void 0!==t&&t,n=e.type,c=void 0===n?"1":n,s=e.text,r=void 0===s?" ":s,i=e.children,o=e.size,l=e.weight,u=e.color,d={};return void 0!==o&&(d.fontSize=o),void 0!==l&&(d.fontWeight=parseInt(l)),void 0!==u&&(d.color=u),Object(j.jsxs)(j.Fragment,{children:[a?Object(j.jsx)("p",{className:"textBlock-header textBlock-header__".concat(c),style:d,children:r}):Object(j.jsx)("p",{className:"textBlock-plain textBlock-plain__".concat(c),style:d,children:r}),i]})}),L=a(3),B=Object(L.c)(function(){var e=Object(d.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new FormData).append("login",t.login),a.append("password",t.password),a.append("captcha",t.captcha),e.next=6,fetch("".concat(m.API_URL,"/api/auth/login"),{method:"POST",body:a,credentials:"include"});case 6:if(!(n=e.sent).ok){e.next=15;break}return e.t0=n.status,e.next=11,n.text();case 11:return e.t1=e.sent,e.abrupt("return",{status:e.t0,text:e.t1});case 15:if(400!=n.status){e.next=23;break}return e.t2=n.status,e.next=19,n.text();case 19:return e.t3=e.sent,e.abrupt("return",{status:e.t2,text:e.t3});case 23:return e.t4=n.status,e.next=26,n.text();case 26:return e.t5=e.sent,e.abrupt("return",{status:e.t4,text:e.t5});case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),q=Object(L.f)({}).on(B.doneData,(function(e,t){var a=e;return 200===t.status?(localStorage.setItem("websocket",t.text),window.location.pathname=n.SCREEN_CHAT,a.connectKey=t.text):a.formError=t.text,a})),H=a(10),U=_.a({login:_.c().required("Login is required"),password:_.c().required("Password is required"),captcha:_.c().required("Captcha is required").min(5,"Captcha has 5 characters").max(5,"Captcha has 5 characters")}).required(),A=function(e){var t,a,n,c=e.children,s=void 0===c?"":c,r=Object(F.d)({resolver:Object(R.a)(U)}),i=r.register,l=r.handleSubmit,u=r.formState.errors,d=Object(o.g)(),p=Object(H.a)(q);return Object(j.jsxs)("form",{className:"loginForm",onSubmit:l(B),children:[Object(j.jsxs)("div",{className:"loginForm-inputGroup",children:[Object(j.jsx)(C,{msg:null===(t=u.login)||void 0===t?void 0:t.message,registerInput:i("login"),placeholder:"Input user name",label:"User name"}),Object(j.jsx)(C,{msg:null===(a=u.password)||void 0===a?void 0:a.message,registerInput:i("password"),placeholder:"Input password",label:"Input password",type:"password"}),Object(j.jsx)(I,{registerInput:i("captcha"),msg:null===(n=u.captcha)||void 0===n?void 0:n.message})]}),s,p.formError?Object(j.jsx)("div",{className:"loginForm-formError",children:Object(j.jsx)(T,{text:p.formError})}):null,Object(j.jsxs)("div",{className:"loginForm-btnGroup",children:[Object(j.jsx)(k,{type:"submit",text:"Log in"}),Object(j.jsx)(k,{type:"button",isLink:!0,text:"Registration",onClick:function(){d.push("/signup")}})]})]})},M=Object(L.d)(),P=Object(L.d)(),G=Object(L.f)({handleRegisterSubmit:function(){return 0}}).on(M,(function(e,t){e.formError=t})).on(P,(function(e,t){e.handleRegisterSubmit=t})),J=(a(200),a.p+"static/media/droparrow.6d562a0b.svg"),z=function(e){var t,a=e.optionList,n=e.registerInput,s=e.setValue,r=e.msg,i=e.label,o=void 0===i?"Select Option":i,l=e.placeholder,u=void 0===l?"Select Option":l,d=Object(c.useState)("1"),p=Object(w.a)(d,2),m=p[0],b=p[1],f=Object(c.useState)(!0),h=Object(w.a)(f,2),O=h[0],v=h[1],x=function(e){v(!0);var t=e.currentTarget.getAttribute("value");t&&(b(t),s("gender_id",t))};return Object(j.jsxs)("div",{className:"optionSelector",children:[Object(j.jsxs)("label",{className:"optionSelector-label",children:[Object(j.jsx)("p",{children:o}),Object(j.jsx)("input",{className:"optionSelector-fakeinput",placeholder:u,onClick:function(){v((function(e){return!e}))},readOnly:!0,value:null===(t=a.find((function(e){return e.id===m&&e.name})))||void 0===t?void 0:t.name}),Object(j.jsx)("input",{className:"optionSelector-input",readOnly:!0,onChange:function(e){n.onChange(e).then((function(){var t=e.currentTarget.getAttribute("value");t&&(e.currentTarget.value=t)}))},onBlur:n.onBlur,ref:n.ref,placeholder:"Choose gender"})]}),Object(j.jsx)("img",{className:"optionSelector-dropicon",src:J,alt:g(J)}),Object(j.jsx)("ul",{className:"optionSelector-list ".concat(O?"optionSelector-list__closed":"optionSelector-list__opened"),children:a.map((function(e){return Object(j.jsx)("li",{className:"optionSelector-element",onClick:x,value:e.id,children:e.name},e.id)}))}),r?Object(j.jsx)(j.Fragment,{children:Object(j.jsx)("p",{className:"optionSelector-msg optionSelector-msg__error",children:r})}):null]})},D=(a(201),Object(L.d)()),W=Object(L.f)([]).on(D,(function(e,t){null===t||void 0===t||t.genders.map((function(t){e.push(t)}))})),V=_.a({login:_.c().required("Login is required"),password:_.c().required("Password is required").min(5,"Password must be at least 5 characters"),password_confirm:_.c().required("Confirm password is required").oneOf([_.b("password")],"Password must match"),name:_.c().required("Name is required").min(5,"Name must be at least 5 characters"),gender_id:_.c().required("Gender is required"),captcha:_.c().required("Captcha is required")}).required(),X=function(){var e,t,a,n,s,r=Object(F.d)({resolver:Object(R.a)(V)}),i=r.register,l=r.handleSubmit,u=r.formState.errors,d=r.setValue,p=Object(H.a)(G),m=Object(H.a)(W),b=Object(c.useState)([{id:"0",name:"default"}]),f=Object(w.a)(b,2),h=f[0],O=f[1],g=Object(o.g)();return Object(c.useEffect)((function(){var e=[];m.map((function(t){e.push({id:t.id,name:t.gender[0].toUpperCase()+t.gender.slice(1)})})),O(e)}),[D]),Object(j.jsxs)("form",{className:"registerForm",onSubmit:l(p.handleRegisterSubmit),children:[Object(j.jsxs)("div",{className:"registerForm-inputGroup",children:[Object(j.jsx)(C,{placeholder:"Input user name",label:"Input user name",registerInput:i("login"),msg:null===(e=u.login)||void 0===e?void 0:e.message}),Object(j.jsx)(C,{placeholder:"Create password",label:"Create password",registerInput:i("password"),msg:null===(t=u.password)||void 0===t?void 0:t.message,type:"password"}),Object(j.jsx)(C,{placeholder:"Password confirmation",label:"Password confirmation",registerInput:i("password_confirm"),msg:null===(a=u.password_confirm)||void 0===a?void 0:a.message,type:"password"}),Object(j.jsx)(C,{placeholder:"Nickname",label:"Nickname",registerInput:i("name"),msg:null===(n=u.name)||void 0===n?void 0:n.message}),Object(j.jsx)(z,{label:"Your gender",placeholder:"Your gender",optionList:h,registerInput:i("gender_id"),setValue:d}),Object(j.jsx)(I,{registerInput:i("captcha"),msg:null===(s=u.captcha)||void 0===s?void 0:s.message})]}),p.formError?Object(j.jsx)("div",{className:"registerForm-formError",children:Object(j.jsx)(T,{text:p.formError,color:"red"})}):null,Object(j.jsxs)("div",{className:"registerForm-btnGroup",children:[Object(j.jsx)(k,{type:"submit",text:"Sign up"}),Object(j.jsx)(k,{type:"button",isLink:!0,text:"Log in",onClick:function(){g.push("/login")}})]})]})},Y=(a(202),a.p+"static/media/chatlogo.c96a0da5.svg"),K=function(){return Object(j.jsx)("img",{className:"applogo",src:Y,alt:g(Y)})},Q=function(e){var t=e.headerText,a=e.underText;e.children;return Object(j.jsxs)("div",{className:"wellcomeHeader",children:[Object(j.jsx)(K,{}),Object(j.jsxs)("div",{className:"wellcomeHeader-string",children:[Object(j.jsx)(T,{text:"".concat(t," "),type:"1",isHeader:!0}),Object(j.jsx)(T,{text:"Chatty",isHeader:!0,type:"1",color:"#5E93E7"}),Object(j.jsx)(T,{text:"!",isHeader:!0,type:"1",color:"#B3CDF8"})]}),Object(j.jsx)(T,{text:a,isHeader:!0,type:"2"})]})},Z=function(){var e=Object(o.h)(),t=Object(j.jsx)(A,{}),a=Object(j.jsx)(Q,{headerText:"Sign Up to\xa0",underText:"Registration"});return e.pathname===n.SCREEN_LOGIN?(a=Object(j.jsx)(Q,{headerText:"Wellcome to\xa0",underText:"Please, authorize yourself"}),t=Object(j.jsx)(A,{})):e.pathname===n.SCREEN_REGISTER&&(a=Object(j.jsx)(Q,{headerText:"Sign Up to\xa0",underText:"Registration"}),t=Object(j.jsx)(X,{})),Object(j.jsxs)("section",{className:"wellcomeTemplate",children:[Object(j.jsx)("article",{className:"loginContainer",children:Object(j.jsx)(p,{authPage:t,authHeader:a})}),Object(j.jsx)(N,{})]})},$=function(){var e=Object(o.g)(),t=function(){var t=Object(d.a)(u.a.mark((function t(a){var c,s,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(c=new FormData).append("login",a.login),c.append("password",a.password),c.append("password_confirm",a.password_confirm),c.append("name",a.name),c.append("gender_id",a.gender_id),c.append("captcha",a.captcha),t.next=9,fetch("".concat(m.API_URL,"/api/auth/register"),{method:"POST",body:c,credentials:"include"});case 9:if(!(s=t.sent).ok){t.next=14;break}e.push("".concat(n.SCREEN_LOGIN)),t.next=19;break;case 14:if(400!=s.status){t.next=19;break}return t.next=17,s.text();case 17:r=t.sent,M(r);case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(c.useEffect)((function(){O().then((function(e){D(e)})).catch((function(e){console.log(e)})),P(t)}),[]),Object(j.jsx)(Z,{})},ee=(a(203),a.p+"static/media/defaultAvatar.639548b6.svg"),te=function(e){var t=e.avatarImage,a=void 0===t?ee:t,n=e.style;return Object(j.jsx)("img",{style:n,className:"avatar",src:a,alt:g(a)})},ae=(a(204),a.p+"static/media/accounticon.dbb31048.svg"),ne=function(){return Object(j.jsxs)("header",{className:"appheader",children:[Object(j.jsx)(K,{}),Object(j.jsx)(te,{avatarImage:ae,style:{boxShadow:"0px 2px 8px rgba(0, 0, 0, 0.08)"}})]})},ce=(a(205),a.p+"static/media/maleIcon.97de65f1.svg"),se=a.p+"static/media/femaleIcon.97de65f1.svg",re=a.p+"static/media/nousericon.2a176518.svg",ie=function(e){var t=e.userCard,a=void 0===t?{username:"User name",recentMsg:"Hey!",isFromMe:!1,selected:!1}:t,n=e.handleClickUserCard;return Object(j.jsxs)("div",{onClick:n,"data-username":a.username,"data-selected":a.isSelected,className:"userCard",children:[Object(j.jsx)(te,{avatarImage:a.avatar?"male"===a.gender?ce:"female"===a.gender?se:re:a.avatar}),Object(j.jsxs)("div",{className:"userCard-textBlock",children:[Object(j.jsx)(T,{text:a.username,isHeader:!0,type:"4"}),Object(j.jsxs)("div",{className:"userCard-msg",children:[a.isFromMe?Object(j.jsx)(T,{text:"You:\xa0",type:"2",color:a.isSelected?"#FFFFFF":"#5E93E7"}):null,Object(j.jsx)(T,{text:a.recentMsg,type:"2"})]})]})]})},oe=(a(206),Object(L.d)()),le=Object(L.d)(),ue=Object(L.d)(),de=Object(L.d)(),je=Object(L.f)([]).on(oe,(function(e,t){var a=[];return t.map((function(e){var t={username:e.name,gender:e.gender,isSelected:!1,isOnline:!0};a.push(t)})),a})).on(le,(function(e){e.splice(0,e.length)})).on(ue,(function(e,t){t.send(JSON.stringify({type:"user_data"})),t.send(JSON.stringify({type:"users_list"}))})).on(de,(function(e,t){var a=e;return a.find((function(e){e.isSelected=e.username===t})),a})),pe={height:"200px",width:"200px",borderRadius:"100px"},me=function(e){var t=e.handleUserCardClick,a=Object(c.useState)([]),n=Object(w.a)(a,2),s=n[0],r=n[1],i=Object(H.a)(je);return Object(c.useEffect)((function(){r(i)}),[i]),Object(j.jsx)(j.Fragment,{children:0!==(null===s||void 0===s?void 0:s.length)&&s?Object(j.jsx)("div",{className:"userList",children:s.map((function(e,a){return Object(j.jsx)(ie,{handleClickUserCard:t,userCard:e},"".concat(e.username).concat(a))}))}):Object(j.jsxs)("div",{className:"userList userList__noUser",children:[Object(j.jsx)(te,{avatarImage:re,style:pe}),Object(j.jsx)(T,{text:"There is no other users yet",size:"15px"})]})})},be=(a(207),a(208),a.p+"static/media/fileIcon.8c96d83e.svg"),fe=(a(209),a(210),function(e){var t=e.src;return Object(j.jsx)("img",{className:"image",src:t,alt:g(t)})}),he=function(e){var t=e.filepath,a=void 0===t?"":t,n=Object(c.useState)({filename:"file_name_001",fileSize:"2.4 MB",filePreview:be,fileFormat:"doc"}),s=Object(w.a)(n,2),r=s[0],i=s[1];return Object(c.useEffect)((function(){var e=new XMLHttpRequest;e.open("GET","".concat(a),!0),e.responseType="blob",e.onreadystatechange=function(){if(this.readyState==this.DONE){var e,t,n={filename:g(a),filePreview:"".concat(a),fileSize:h(null===(e=this.response)||void 0===e?void 0:e.size),fileFormat:null===(t=this.response)||void 0===t?void 0:t.type};i(n)}},e.send(null)}),[]),Object(j.jsx)("a",{className:"file",href:a,children:"image/jpg"===r.fileFormat||"image/png"===r.fileFormat||"image/jpeg"===r.fileFormat||"image/gif"===r.fileFormat?Object(j.jsx)(fe,{src:r.filePreview}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("img",{src:be,className:"file-icon",alt:g(be)}),Object(j.jsxs)("div",{className:"file-description",children:[Object(j.jsx)(T,{text:r.filename,type:"1",weight:"600"}),Object(j.jsx)(T,{text:r.fileSize,weight:"400",type:"2"})]})]})})},Oe=function(e){var t=e.messageItem,a=void 0===t?{text:"Hey!",isFromMe:!0,files:[]}:t;return Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)("div",{className:"messageBlock messageBlock__".concat(a.isFromMe?"fromMe":"fromChat"),children:[Object(j.jsx)(T,{text:a.text,weight:"400"}),0!==a.files.length?a.files.map((function(e,t){return Object(j.jsx)(he,{filepath:e},"".concat(e).concat(t))})):null]})})},ge=(a(211),a.p+"static/media/backIcon.d3fd6ea1.svg"),ve=function(e){var t=e.chattingUser,a=void 0===t?{username:"Marina Joe",isOnline:!1,lastSeen:"3 minute ago",avatar:ee}:t,n=e.handleBackClick;return Object(j.jsxs)("div",{className:"chatHeader",children:[Object(j.jsx)("img",{onClick:n,src:ge,alt:g(ge)}),Object(j.jsx)(te,{avatarImage:ee}),Object(j.jsxs)("div",{className:"chatHeader-nameAndStatus",children:[Object(j.jsx)(T,{text:a.username,isHeader:!0,type:"3"}),Object(j.jsx)(T,{text:a.isOnline?"Online":"Last seen ".concat(a.lastSeen),color:"#949494"})]})]})},xe=a(4),Ne=a.p+"static/media/sendMessage.bff66a4e.svg",Se=a.p+"static/media/pinFile.cc6bfb49.svg",we=(a(212),Object(L.d)()),ye=Object(L.f)({}).on(we,(function(e,t){var a=e;return a.websocket=t,a})),Ce=Object(L.d)(),ke=Object(L.f)({}).on(Ce,(function(e,t){e.name=t.name,e.gender=t.gender})),Ee=function(){var e=Object(c.useState)(),t=Object(w.a)(e,2),a=(t[0],t[1]),n=Object(c.useState)(!0),s=Object(w.a)(n,2),r=s[0],i=s[1],l=Object(c.useState)(""),u=Object(w.a)(l,2),d=u[0],p=u[1],h=Object(c.useState)(""),O=Object(w.a)(h,2),v=O[0],x=O[1],N=Object(c.useState)([]),S=Object(w.a)(N,2),y=S[0],C=S[1],k=Object(o.i)().username,E=Object(H.a)(ke),I=Object(H.a)(ye);return Object(j.jsxs)(j.Fragment,{children:[y.length>0?Object(j.jsx)("div",{className:"previewFile",children:y.map((function(e){return Object(j.jsx)("div",{children:Object(j.jsx)(he,{filepath:e})},e)}))}):null,Object(j.jsxs)("form",{className:"chatInput",onSubmit:function(e){if(e.preventDefault(),(d.length>0||y.length>0)&&r){var t,a={type:"chats",data:{text:d,files:y,usersender:E.name,userreciver:k}};null===(t=I.websocket)||void 0===t||t.send('"'.concat(JSON.stringify(a),'"')),C([]),p("")}},children:[Object(j.jsxs)("label",{children:[Object(j.jsx)("p",{className:"chatInput-fileError",children:v}),Object(j.jsx)("img",{src:Se,alt:g(Se)}),Object(j.jsx)("input",{className:"chatInput-file",type:"file",onChange:function(e){i(!1),x("");var t,n=e.currentTarget.files;if(null===n||void 0===n?void 0:n[0]){if(n[0].size>2097152)return void x("Max size of file 2MB");if(t=n[0].type,!b.find((function(e){return e===t})))return void x("Not allowed type of data");var c={files:n};!function(e){if(e.url){var t;e.method=e.method||"POST",e.events=e.events||{};try{t=new XMLHttpRequest}catch(i){return void console.log("Not completable browser")}t.onreadystatechange=function(){if(4==t.readyState){var a,n,c,s,r=t.responseText;try{r=JSON.parse(r)}catch(i){console.log(i)}200===t.status?f(null===(a=e.events)||void 0===a?void 0:a.success)&&(null===(n=e.events)||void 0===n?void 0:n.success)&&e.events.success(r,t):f(null===(c=e.events)||void 0===c?void 0:c.error)&&(null===(s=e.events)||void 0===s?void 0:s.error)&&(console.log(t.status+": "+t.statusText),e.events.error(r,t))}else{var o,l;f(null===(o=e.events)||void 0===o?void 0:o.wait)&&(null===(l=e.events)||void 0===l?void 0:l.wait)&&e.events.wait()}};var a=null;if(e.data=e.data||{},e.data.files){var n;for(var c in e.method="POST",a=new FormData,e.data)if("object"==typeof e.data[c])for(var s in e.data[c]){var r=e.data[c][s];"object"==typeof r?a.append(s,r,r.name):a.append(s,r)}else a.append(c,e.data[c]);f(null===(n=e.events)||void 0===n?void 0:n.progress)&&(t.upload.onprogress=function(t){var a;(null===(a=e.events)||void 0===a?void 0:a.progress)&&e.events.progress(t)})}e.method=e.method.toUpperCase(),"GET"==e.method&&a&&(e.url+="?"+a),t.open(e.method,e.url,!0),e.data.files||t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.withCredentials=!0,t.send(a)}}({url:"".concat(m.API_URL,"/api/upload"),method:"POST",data:c,events:{success:function(e,t){i(!0),C([].concat(Object(xe.a)(y),["".concat(m.API_URL,"/").concat(e)]))},error:function(e,t){x(e)},progress:function(e){a((null===e||void 0===e?void 0:e.loaded)/(null===e||void 0===e?void 0:e.total))}}})}}})]}),Object(j.jsx)("input",{className:"chatInput-file",name:"files",value:y,readOnly:!0}),Object(j.jsx)("input",{className:"chatInput-messageInput",placeholder:"Write something...",value:d,onChange:function(e){p(e.currentTarget.value)}}),Object(j.jsxs)("label",{children:[Object(j.jsx)("img",{src:Ne,alt:g(Ne)}),Object(j.jsx)("input",{className:"chatInput-submit",type:"submit"})]})]})]})},Ie=(a(213),Object(L.d)()),_e=(Object(L.c)(),Object(L.d)()),Fe=Object(L.f)([]).on(Ie,(function(e){var t=localStorage.getItem("chats");if(null!==t)return JSON.parse(t);localStorage.setItem("chats",JSON.stringify([]))})).on(_e,(function(e,t){var a=Object(xe.a)(e);return e.find((function(e){return e.username===t.userName&&e}))?a.forEach((function(e){var a;e.username===t.userName&&(null===(a=e.messages)||void 0===a||a.push(t))})):a.push({username:t.userName,messages:[t]}),localStorage.setItem("chats",JSON.stringify(a)),console.log(a===e),a})),Re=function(e){var t=e.children,a=e.handleBackClick,n=Object(c.createRef)(),s=Object(o.i)().username,r=Object(H.a)(je),i=Object(H.a)(Fe),l=Object(c.useState)([]),u=Object(w.a)(l,2),d=u[0],p=u[1],m=Object(c.useState)(r.find((function(e){return e.username===s&&e}))),b=Object(w.a)(m,2),f=b[0],h=b[1];return Object(c.useEffect)((function(){h(r.find((function(e){return e.username===s&&e})))}),[s]),Object(c.useEffect)((function(){var e,t;null===(e=n.current)||void 0===e||e.scrollTo(0,null===(t=n.current)||void 0===t?void 0:t.scrollHeight)}),[s]),Object(c.useEffect)((function(){var e=i.find((function(e){return e.username===s&&e.messages}));(null===e||void 0===e?void 0:e.messages)?p(e.messages):p([])}),[i,s]),Object(j.jsxs)("div",{className:"chatArea",children:[Object(j.jsx)(ve,{handleBackClick:a,chattingUser:f}),Object(j.jsx)("div",{ref:n,className:"chatArea-messageList chatArea-messageList__".concat(0!==(null===d||void 0===d?void 0:d.length)?"withMsg":"noMsg"),children:0!==(null===d||void 0===d?void 0:d.length)?null===d||void 0===d?void 0:d.map((function(e,t){return Object(j.jsx)(Oe,{messageItem:e},"".concat(e.text).concat(t))})):Object(j.jsx)(T,{text:"Write first"})}),t,Object(j.jsx)(Ee,{})]})},Te=a.p+"static/media/chatBeautyBackground.c08ad226.svg",Le=function(e){var t=e.username,a=e.isChatDisplay,n=e.handleBackClick,c=e.handleUserCardClick,s={backgroundImage:"url(".concat(Te,")")},r={};return r.marginLeft=a?"-100%":"0",Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(ne,{}),Object(j.jsxs)("section",{style:r,className:"chatContainer",children:[Object(j.jsx)(me,{handleUserCardClick:c}),Object(j.jsx)("div",{className:"chatContainer-chat",style:s,children:void 0!==t?Object(j.jsx)(Re,{handleBackClick:n}):Object(j.jsx)(T,{text:"Select a chat to stray messaging"})})]})]})},Be=function(){var e=Object(o.g)(),t=Object(H.a)(ke),a=null;void 0===localStorage.getItem("websocket")?e.push("".concat(n.SCREEN_LOGIN)):(a=localStorage.getItem("websocket"))?a=a.replaceAll('"',""):e.push("".concat(n.SCREEN_LOGIN));var s=Object(o.i)().username;s&&de(s);var r=Object(c.useState)(!1),i=Object(w.a)(r,2),l=i[0],p=i[1];return Object(c.useEffect)((function(){window.matchMedia("(max-width: 768px)").matches&&p(!1),Ie(),O().then((function(e){D(e)})).catch((function(e){console.log(e)}));var c=new WebSocket("".concat(m.WS_URL,"/?type=test&ws_id=").concat(a));c.onmessage=function(){var a=Object(d.a)(u.a.mark((function a(c){var s,r,i,o,l,d;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,"Get param 'ws_id' - is wrong! Please relogin!"===(s=c.data)?e.push("".concat(n.SCREEN_LOGIN)):'"'===s[0]&&s[s.length-1]&&(s=(s=c.data.slice(1)).slice(0,-1)),a.next=5,JSON.parse(s);case 5:"users_list"===(null===(r=a.sent)||void 0===r?void 0:r.type)?(le(),null===r||void 0===r||r.data.forEach((function(e,a,n){e.name===t.name&&e.gender===t.gender&&n.splice(a,1)})),oe(null===r||void 0===r?void 0:r.data)):"user_data"===(null===r||void 0===r?void 0:r.type)?Ce(null===r||void 0===r?void 0:r.data):"chats"===(null===r||void 0===r?void 0:r.type)&&(l={userName:r.data.userreciver,files:r.data.files,isFromMe:!1,text:r.data.text},(null===(i=r.data)||void 0===i?void 0:i.usersender)===t.name?l.isFromMe=!0:(null===(o=r.data)||void 0===o?void 0:o.userreciver)===t.name&&(l.userName=null===(d=r.data)||void 0===d?void 0:d.usersender),_e(l)),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(0),console.log(a.t0);case 12:case"end":return a.stop()}}),a,null,[[0,9]])})));return function(e){return a.apply(this,arguments)}}(),c.onopen=function(){ue(c)},c.onclose=function(){le(),localStorage.removeItem("websocket")},we(c)}),[]),Object(j.jsx)(Le,{handleUserCardClick:function(t){window.matchMedia("(max-width: 768px)").matches&&p(!0),e.push("".concat(n.SCREEN_CHAT,"/").concat(t.currentTarget.getAttribute("data-username")))},handleBackClick:function(){p(!1),e.push("".concat(n.SCREEN_CHAT,"/0"))},isChatDisplay:l,username:s})},qe=Object(o.j)((function(){return Object(j.jsxs)(o.d,{children:[Object(j.jsx)(o.b,{path:n.SCREEN_LOGIN,exact:!0,children:Object(j.jsx)($,{})}),Object(j.jsx)(o.b,{path:n.SCREEN_REGISTER,exact:!0,children:Object(j.jsx)($,{})}),Object(j.jsx)(o.b,{path:n.SCREEN_CHAT,exact:!0,children:Object(j.jsx)(Be,{})}),Object(j.jsx)(o.b,{path:n.SCREEN_CONVERSATION,children:Object(j.jsx)(Be,{})}),Object(j.jsx)(o.a,{to:n.SCREEN_LOGIN})]})})),He=a(17),Ue=function(){return Object(j.jsx)("div",{className:"App",children:Object(j.jsx)(He.a,{children:Object(j.jsx)(qe,{})})})};i.a.render(Object(j.jsx)(s.a.StrictMode,{children:Object(j.jsx)(Ue,{})}),document.getElementById("root"))},85:function(e,t,a){},87:function(e,t,a){},89:function(e,t,a){},91:function(e,t,a){},92:function(e,t,a){},93:function(e,t,a){},94:function(e,t,a){},95:function(e,t,a){},96:function(e,t,a){}},[[214,1,2]]]);
//# sourceMappingURL=main.52306223.chunk.js.map